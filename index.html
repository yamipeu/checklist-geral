<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checklists de Protocolos</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='80' font-size='80'>ðŸ“‹</text></svg>">

<style>
*{box-sizing:border-box;font-family:Arial}
body{margin:0;background:#0f0f0f;color:white}
.hidden{display:none}

header{
background:linear-gradient(90deg,#600,#e21);
padding:15px 30px;
display:flex;
justify-content:space-between;
align-items:center
}

button{
background:#e21;border:none;color:white;
padding:10px 20px;border-radius:6px;
cursor:pointer
}
button:hover{opacity:.8}

.card{
background:#1b1b1b;
max-width:900px;
margin:40px auto;
padding:30px;
border-radius:15px;
animation:fade .4s
}

@keyframes fade{from{opacity:0;transform:translateY(20px)}to{opacity:1}}

input{
width:100%;padding:10px;border-radius:6px;border:none;margin-bottom:10px
}

.check{
display:flex;
justify-content:space-between;
align-items:center;
border-bottom:1px solid #333;
padding:15px 0
}

.progress{height:10px;background:#333;border-radius:6px;overflow:hidden}
.bar{height:100%;background:#e21;width:0%;transition:.3s}

.avatar{
width:40px;height:40px;border-radius:50%;
border:2px solid red;cursor:pointer;object-fit:cover
}

.modal{
position:fixed;inset:0;background:rgba(0,0,0,.7);
display:flex;align-items:center;justify-content:center
}
.modal img{max-width:300px;border-radius:15px}

.dashboard{
display:grid;grid-template-columns:1fr 1fr;gap:20px
}

.small{opacity:.7;font-size:14px}

</style>
</head>

<body>

<header>
<strong>Checklists de Protocolos</strong>
<div id="topRight" class="hidden">
<img id="avatarTop" class="avatar">
<button onclick="logout()">Logout</button>
</div>
</header>

<!-- LOGIN -->
<div id="loginScreen" class="card">
<h2>Login</h2>
<input id="username" placeholder="Digite seu username">
<button onclick="doLogin()">Entrar</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="card hidden">
<h2 id="hello"></h2>

<div class="dashboard">
<div>
<p>Total de atendimentos:</p>
<h1 id="count">0</h1>
</div>

<div>
<input type="file" id="photoInput">
</div>
</div>

<br>

<button onclick="openChecklist('me')">MudanÃ§a de EndereÃ§o</button>
<button onclick="openChecklist('ap')">AtualizaÃ§Ã£o de Plano</button>

</div>

<!-- CHECKLIST -->
<div id="checklist" class="card hidden">
<h2 id="title"></h2>

<div class="progress"><div id="bar" class="bar"></div></div><br>

<div id="items"></div><br>

<button onclick="finish()">Finalizar atendimento</button>
<button onclick="back()">Voltar</button>
</div>

<div id="photoModal" class="modal hidden" onclick="this.classList.add('hidden')">
<img id="bigPhoto">
</div>

<script>

const ME=[
"Informar sobre custo/isenÃ§Ã£o, pedir para levar o equipamento e informar SLA",
"Filtrar o novo endereÃ§o",
"Verificar documentos",
"Verificar se jÃ¡ houve ME ou se pode ser isento",
"Abrir ME no ERP",
"Verificar se hÃ¡ atualizaÃ§Ã£o de plano (abrir atualizaÃ§Ã£o e enviar para o FAT, caso haja)",
"Gerar contrato (verificar informaÃ§Ãµes em sistema)",
"Abrir a renovaÃ§Ã£o (apÃ³s o cliente assinar)",
"Encaminhar para a CS"
];

const AP=[
"Informar sobre o processo e benefÃ­cios",
"Verificar documentaÃ§Ã£o e faturas",
"Abrir a atualizaÃ§Ã£o no ERP e preencher",
"Conferir informaÃ§Ãµes em sistema",
"Enviar vÃ­deo para o/a cliente",
"Gerar contrato",
"Abrir a renovaÃ§Ã£o apÃ³s a assinatura subir em sistema",
"Encerrar renovaÃ§Ã£o"
];

let currentUser=localStorage.user||"";

if(currentUser) init();

function doLogin(){
currentUser=username.value.trim();
if(!currentUser)return alert("Digite o nome");
localStorage.user=currentUser;
init();
}

function init(){
loginScreen.classList.add("hidden");
dashboard.classList.remove("hidden");
topRight.classList.remove("hidden");
hello.innerText="OlÃ¡, "+currentUser;

count.innerText=localStorage["count_"+currentUser]||0;

let photo=localStorage["photo_"+currentUser];
if(photo){
avatarTop.src=photo;
bigPhoto.src=photo;
}else avatarTop.src="https://via.placeholder.com/40";
}

function logout(){
localStorage.removeItem("user");
location.reload();
}

photoInput.onchange=e=>{
const r=new FileReader();
r.onload=()=>{
localStorage["photo_"+currentUser]=r.result;
avatarTop.src=r.result;
bigPhoto.src=r.result;
}
r.readAsDataURL(e.target.files[0]);
}

avatarTop.onclick=()=>photoModal.classList.remove("hidden");

function openChecklist(t){
dashboard.classList.add("hidden");
checklist.classList.remove("hidden");
items.innerHTML="";
title.innerText=t=="me"?"MudanÃ§a de EndereÃ§o":"AtualizaÃ§Ã£o de Plano";

let arr=t=="me"?ME:AP;

arr.forEach((txt,i)=>{
items.innerHTML+=`
<div class="check">
<span>${txt}</span>
<input type="checkbox" onchange="update()">
</div>`;
});

update();
}

function update(){
let c=[...document.querySelectorAll("input[type=checkbox]")];
let done=c.filter(x=>x.checked).length;
bar.style.width=(done/c.length*100)+"%";
}

function finish(){
let k="count_"+currentUser;
localStorage[k]=(Number(localStorage[k]||0)+1);
alert("Atendimento finalizado!");
location.reload();
}

function back(){
checklist.classList.add("hidden");
dashboard.classList.remove("hidden");
}

</script>
</body>
</html>
