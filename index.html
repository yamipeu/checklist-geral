<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Checklists de Protocolos</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
--red:#d72626;
--bg:#0b0b0b;
--card:#161616;
}

*{box-sizing:border-box}

body{
margin:0;
font-family:Segoe UI,Arial;
background:var(--bg);
color:white;
}

.hidden{display:none}

header{
background:#111;
padding:15px 25px;
display:flex;
justify-content:space-between;
align-items:center;
}

button{
background:var(--red);
border:none;
color:white;
padding:10px 18px;
border-radius:6px;
cursor:pointer;
}

.container{
max-width:1000px;
margin:40px auto;
padding:20px;
}

.card{
background:var(--card);
border-radius:14px;
padding:25px;
box-shadow:0 15px 40px rgba(0,0,0,.6);
}

input{
width:100%;
padding:10px;
border-radius:6px;
border:none;
margin-top:10px;
background:#222;
color:white;
}

.dashboard{
display:grid;
grid-template-columns:1fr 2fr;
gap:30px;
}

.avatar{
width:60px;
height:60px;
border-radius:50%;
border:2px solid var(--red);
object-fit:cover;
cursor:pointer;
}

.tiles{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
gap:20px;
}

.tile{
background:#1c1c1c;
padding:30px;
border-radius:12px;
text-align:center;
cursor:pointer;
}

.checkline{
display:flex;
justify-content:space-between;
align-items:center;
border-bottom:1px solid #333;
padding:15px 0;
}

.progress{
height:8px;
background:#333;
border-radius:6px;
overflow:hidden;
margin:15px 0;
}

.bar{
height:100%;
background:var(--red);
width:0%;
transition:.3s;
}

.modal{
position:fixed;
inset:0;
background:rgba(0,0,0,.8);
display:flex;
align-items:center;
justify-content:center;
opacity:0;
pointer-events:none;
transition:.3s;
}

.modal.active{
opacity:1;
pointer-events:auto;
}

.modal img{
max-width:300px;
border-radius:12px;
}

.topBtns{
display:flex;
gap:10px;
margin-bottom:15px;
}

</style>
</head>

<body>

<header>
<b>Checklists de Protocolos</b>
<div>
<span id="hello"></span>
<button onclick="logout()">Logout</button>
</div>
</header>

<div id="loginScreen" class="container">
<div class="card">
<h2>Login</h2>
<input id="username" placeholder="Digite seu username">
<button style="width:100%;margin-top:15px" onclick="doLogin()">Entrar</button>
</div>
</div>

<div id="dashboard" class="container hidden">
<div class="dashboard">

<div class="card">
<img id="avatar" class="avatar"><br><br>
<b id="userName"></b>
<p>Atendimentos: <span id="count">0</span></p>
<input type="file" onchange="upload(this)">
</div>

<div class="card">
<h2>Ol√°, <span id="hello2"></span></h2>
<div class="tiles">
<div class="tile" onclick="openChecklist('me')">Mudan√ßa de Endere√ßo</div>
<div class="tile" onclick="openChecklist('plano')">Atualiza√ß√£o de Plano</div>
</div>
</div>

</div>
</div>

<div id="checklist" class="container hidden">
<div class="topBtns">
<button onclick="back()">‚¨Ö Voltar</button>
<button onclick="resetChecklist()">üîÑ Resetar</button>
</div>

<div class="card">
<h2 id="title"></h2>
<div class="progress"><div id="bar" class="bar"></div></div>
<div id="steps"></div>
<button style="width:100%;margin-top:20px" onclick="finish()">Finalizar atendimento</button>
</div>
</div>

<div id="photoModal" class="modal" onclick="closePhoto()">
<img id="bigPhoto">
</div>

<script>
const lists={
me:[
"Informar sobre custo/isen√ß√£o, pedir para levar o equipamento e informar SLA",
"Filtrar o novo endere√ßo",
"Verificar documentos",
"Verificar se j√° houve ME ou se pode ser isento",
"Abrir ME no ERP",
"Verificar se h√° atualiza√ß√£o de plano (abrir atualiza√ß√£o e enviar para o FAT, caso haja)",
"Gerar contrato (verificar informa√ß√µes em sistema)",
"Abrir a renova√ß√£o (ap√≥s o cliente assinar)",
"Encaminhar para a CS"
],
plano:[
"Informar sobre o processo e benef√≠cios",
"Verificar documenta√ß√£o e faturas",
"Abrir a atualiza√ß√£o no ERP e preencher",
"Conferir informa√ß√µes em sistema",
"Enviar v√≠deo para o/a cliente",
"Gerar contrato",
"Abrir a renova√ß√£o ap√≥s a assinatura subir em sistema",
"Encerrar renova√ß√£o"
]
};

let user=null;

window.onload=()=>{
 if(localStorage.currentUser){
   user=localStorage.currentUser;
   showDashboard();
 }
};

function doLogin(){
 user=username.value.trim();
 if(!user)return;
 localStorage.currentUser=user;
 if(!localStorage[user])localStorage[user]=JSON.stringify({count:0,photo:null});
 showDashboard();
}

function logout(){
 localStorage.removeItem("currentUser");
 location.reload();
}

function showDashboard(){
 loginScreen.classList.add("hidden");
 dashboard.classList.remove("hidden");
 hello.innerText="Ol√°, "+user;
 hello2.innerText=user;
 userName.innerText=user;

 let u=JSON.parse(localStorage[user]);
 count.innerText=u.count;
 avatar.src=u.photo||"https://via.placeholder.com/60";
}

function upload(i){
 let r=new FileReader();
 r.onload=e=>{
   let u=JSON.parse(localStorage[user]);
   u.photo=e.target.result;
   localStorage[user]=JSON.stringify(u);
   avatar.src=e.target.result;
 };
 r.readAsDataURL(i.files[0]);
}

avatar.onclick=()=>{
 bigPhoto.src=avatar.src;
 photoModal.classList.add("active");
};

function closePhoto(){
 photoModal.classList.remove("active");
}

function openChecklist(type){
 dashboard.classList.add("hidden");
 checklist.classList.remove("hidden");
 title.innerText=type=="me"?"Mudan√ßa de Endere√ßo":"Atualiza√ß√£o de Plano";
 steps.innerHTML="";
 lists[type].forEach(t=>{
   steps.innerHTML+=`
   <div class="checkline">
     <span>${t}</span>
     <input type="checkbox" onchange="calc()">
   </div>`;
 });
 calc();
}

function back(){
 checklist.classList.add("hidden");
 dashboard.classList.remove("hidden");
}

function calc(){
 let c=[...document.querySelectorAll("#steps input")];
 let done=c.filter(x=>x.checked).length;
 bar.style.width=(done/c.length*100)+"%";
}

function resetChecklist(){
 document.querySelectorAll("#steps input").forEach(x=>x.checked=false);
 bar.style.width="0%";
}

function finish(){
 let u=JSON.parse(localStorage[user]);
 u.count++;
 localStorage[user]=JSON.stringify(u);
 alert("Atendimento finalizado!");
 location.reload();
}
</script>

</body>
</html>
